import{__assign,__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./TextField.css";import*as React from"react";import{FocusWithin}from"../../FocusWithin";import{FocusZoneContext}from"../../FocusZone";import{FormItemContext}from"../../FormItem";import{Icon,IconSize}from"../../Icon";import{Observer}from"../../Observer";import{Tooltip}from"../../TooltipEx";import{css,getSafeId}from"../../Util";import{getTabIndex}from"../../Utilities/Focus";import{TextFieldFocusTreatmentBehavior,TextFieldStyle,TextFieldWidth}from"./TextField.Props";var inputId=1,TextField=function(n){function e(e){var t=n.call(this,e)||this;return t.select=function(){t.inputElement.current&&t.inputElement.current.select()},t.inputId="textfield-input-"+inputId++,t.inputElement=e.inputElement||React.createRef(),t}return __extends(e,n),e.prototype.focus=function(){this.inputElement.current&&this.inputElement.current.focus()},Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this.inputElement.current?this.inputElement.current.selectionEnd:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.inputElement.current?this.inputElement.current.selectionStart:null},enumerable:!1,configurable:!0}),e.prototype.setSelectionRange=function(e,t,n){this.inputElement.current&&this.inputElement.current.setSelectionRange(e,t,n)},e.prototype.render=function(){var i=this,e=this.props,t=(e.autoAdjustHeight,e.className),r=e.containerClassName,a=e.disabled,n=e.focusTreatment,l=void 0===n?TextFieldFocusTreatmentBehavior.all:n,n=e.inputId,s=e.label,o=e.onBlur,u=e.onFocus,c=e.style,d=e.value,p=e.width,e=React.createElement(FocusWithin,{onFocus:u,onBlur:o},function(o){return React.createElement(FormItemContext.Consumer,null,function(n){return React.createElement("div",{className:css("flex-column",r,p!==TextFieldWidth.auto&&p)},React.createElement("div",{className:css(!s&&t,"bolt-textfield flex-row flex-center",a&&"disabled",l===TextFieldFocusTreatmentBehavior.all&&"focus-treatment",l===TextFieldFocusTreatmentBehavior.keyboardOnly&&"focus-keyboard-only",o.hasFocus&&"focused",c===TextFieldStyle.inline&&"bolt-textfield-inline",n.error&&"bolt-textfield-error")},React.createElement(FocusZoneContext.Consumer,null,function(t){return React.createElement(Observer,{value:d},function(e){return React.createElement(TextFieldInnerValue,__assign({},i.props,{focus:function(){return i.focus()},focusStatus:o,formItemContext:n,inputElement:i.inputElement,inputId:i.props.inputId||i.inputId,value:e.value,zoneContext:t}))})})))})});return s?React.createElement("div",{className:css(t,"flex-column")},React.createElement("label",{htmlFor:getSafeId(n||this.inputId),className:"bolt-textfield-label"},s),e):e},e}(React.Component),TextFieldInnerValue=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.adjustedHeight=-1,e.adjustedHeightValue="",e.hiddenElement=React.createRef(),e}return __extends(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.activatable,o=e.ariaActiveDescendant,i=e.ariaAutoComplete,r=e.ariaControls,a=e.ariaExpanded,l=e.ariaHasPopup,s=e.ariaInvalid,u=e.ariaLabel,c=e.ariaLabelledBy,d=e.ariaRoleDescription,p=e.autoAdjustHeight,m=e.autoComplete,f=e.autoFocus,h=e.autoSelect,x=e.disabled,P=e.excludeFocusZone,b=e.focus,g=e.focusStatus,v=e.formItemContext,I=e.inputClassName,F=e.inputElement,D=e.inputId,y=e.inputType,O=e.maxLength,E=e.maxWidth,C=e.multiline,W=e.onClick,K=e.onKeyDown,A=e.onKeyPress,L=e.onKeyUp,U=e.onPaste,R=e.placeholder,T=e.prefixIconProps,_=e.readOnly,S=e.required,j=e.resizable,V=e.role,H=e.rows,Z=e.spellCheck,N=e.tooltipProps,k=e.value,e=e.zoneContext,B=this.props,w=B.ariaDescribedBy,z=B.suffixIconProps,B=C?"textarea":"input",H=C?{rows:H}:{type:y,autoComplete:m?"on":"off"},m=(void 0===z&&v.error&&(z={className:"bolt-textfield-message-error",iconName:"Error"}),void 0===w&&(w=v.ariaDescribedById),css(I,"bolt-textfield-input flex-grow",p&&"bolt-textfield-auto-adjust",j&&"bolt-textfield-auto-unresizable",T&&"bolt-textfield-input-with-prefix",z&&"bolt-textfield-input-with-suffix",n&&"activatable")),I=void 0!==E?{maxWidth:E}:{},j=React.createElement(B,__assign({},H,{"aria-activedescendant":getSafeId(o),"aria-autocomplete":i,"aria-controls":getSafeId(r),"aria-describedby":getSafeId(w),"aria-disabled":x,"aria-expanded":a,"aria-haspopup":l,"aria-invalid":s,"aria-label":void 0===u&&R?R:u,"aria-labelledby":getSafeId(c)||getSafeId(v.ariaLabelledById),"aria-readonly":y&&"text"!==y?_:void 0,"aria-required":S,"aria-roledescription":d,autoFocus:f,"data-focuszone":x||P?void 0:e.focuszoneId,disabled:x,className:m,id:getSafeId(D),maxLength:O,onBlur:g.onBlur,onClick:W,onChange:function(e){t.props.onChange&&t.props.onChange(e,e.target.value),t.adjustHeight()},onFocus:function(e){h&&F.current&&F.current.select(),g.onFocus&&g.onFocus(e)},onKeyDown:K,onKeyPress:A,onKeyUp:L,onPaste:U,placeholder:R,readOnly:_,required:S,ref:F,role:V,style:I,spellCheck:Z,tabIndex:getTabIndex(this.props),value:k||""}));return C&&p&&(j=React.createElement("div",{className:"flex-row flex-grow relative"},React.createElement(B,{"aria-hidden":!0,className:css("bolt-textfield-auto-adjust-hidden",m),ref:this.hiddenElement,role:"presentation"}),j)),React.createElement(React.Fragment,null,T&&Icon(__assign(__assign({size:IconSize.medium},T),{className:css(T.className,"prefix",!T.render&&"bolt-textfield-icon",(R&&!k||T.render)&&"bolt-textfield-no-text"),onClick:function(e){T&&T.onClick&&T.onClick(e),b()}})),N?React.createElement(Tooltip,__assign({},N),j):j,z&&Icon(__assign(__assign({size:IconSize.medium},z),{className:css(z.className,"suffix",!z.render&&"bolt-textfield-icon",(R&&!k||z.render)&&"bolt-textfield-no-text",z.onClick&&"cursor-pointer"),onClick:function(e){z&&z.onClick&&z.onClick(e),b()}})))},e.prototype.componentDidMount=function(){this.adjustHeight()},e.prototype.componentDidUpdate=function(){this.adjustHeight()},e.prototype.adjustHeight=function(){var e=this.hiddenElement,t=this.props,n=t.autoAdjustHeight,o=t.inputElement,i=t.multiline,t=t.value;i&&n&&o.current&&e.current&&t!==this.adjustedHeightValue&&(e.current.value=o.current.value,this.adjustedHeight!==e.current.scrollHeight)&&(this.adjustedHeight=e.current.scrollHeight,this.adjustedHeightValue=o.current.value,o.current.style.height=this.adjustedHeight+"px")},e}(React.Component);export{TextField};