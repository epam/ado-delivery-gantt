import{__assign,__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./List.css";import"./ListDropIndicator.css";import*as React from"react";import*as Utils_Accessibility from"../../Core/Util/Accessibility";import{ObservableArray,ObservableLike}from"../../Core/Observable";import{format}from"../../Core/Util/String";import{FocusWithin}from"../../FocusWithin";import{FocusZone,FocusZoneContext,FocusZoneDirection}from"../../FocusZone";import{Icon}from"../../Icon";import{Intersection,IntersectionContext}from"../../Intersection";import{getDefaultLinkProps,Link}from"../../Link";import{Observer,UncheckedObserver}from"../../Observer";import*as Resources from"../../Resources.Widgets";import{Tooltip}from"../../TooltipEx";import{css,eventTargetContainsNode,getSafeId,KeyCode}from"../../Util";import{EventDispatch}from"../../Utilities/Dispatch";import{getDragInProgress}from"../../Utilities/DragDrop";import{getTabIndex}from"../../Utilities/Focus";var List=function(s){function e(e){var E=s.call(this,e)||this,t=(E.bodyElement=React.createRef(),E.listElement=React.createRef(),E.spacerElements={},E.scrollToIndex=-1,E.scrollToOptions=void 0,E.selectOnFocus=!0,E.focusIndex=-1,E.pivotIndex=-1,E.onVirtualizeKeyDown=function(e){E.state.virtualize&&e.ctrlKey&&e.altKey&&"v"===e.key&&(e=E.props.itemProvider.length,E.setState({virtualize:!1,lastMaterialized:e-1,lastRendered:e-1,firstMaterialized:0,firstRendered:0}),Utils_Accessibility.announce(Resources.VirtualizationDisabled))},E.onBlur=function(){E.focusIndex=-1},E.onClick=function(e){var t,r;E.onDispatch(e),e.defaultPrevented||e.altKey&&E.props.selectableText||E.listElement.current&&(r=(t=cellFromEvent(e)).cellElement,t=t.rowIndex,r&&eventTargetContainsNode(e,["A"],r)||(r=ObservableLike.getValue(E.state.rows[t]),0<=t&&r&&(r={data:r,index:t},E.props.selectRowOnClick&&E.processSelectionEvent(e,r),E.props.singleClickActivation)&&E.rowActivated(e,r)))},E.onDispatch=function(e){E.state.eventDispatch.dispatchEvent(e)},E.onDoubleClick=function(e){var t,r;E.onDispatch(e),e.defaultPrevented||E.props.singleClickActivation||(t=cellFromEvent(e).rowIndex,r=ObservableLike.getValue(E.state.rows[t]),0<=t&&r&&E.rowActivated(e,{data:r,index:t}))},E.onFocusBody=function(e){var t,r;E.selectOnFocus&&((t=E.props.selection)&&!t.selectOnFocus||0<=(t=E.focusIndex)&&(r=ObservableLike.getValue(E.state.rows[t]))&&E.processSelectionEvent(e,{data:r,index:t}),E.selectOnFocus=!1)},E.onFocusItem=function(e,t){var r=E.focusIndex;r!==e&&(0<=r?delete E.state.renderedRows[r]:delete E.state.renderedRows[E.getInitialTabbableRow()],delete E.state.renderedRows[e],E.focusIndex=e,r=ObservableLike.getValue(E.state.rows[e]))&&E.rowFocused(t,{data:r,index:e})},E.onKeyDown=function(t){var r,e,o;E.onDispatch(t),t.defaultPrevented||"INPUT"!==(e=t.target.nodeName)&&"TEXTAREA"!==e&&(r=E.focusIndex,e=ObservableLike.getValue(E.state.rows[r]))&&(t.which===KeyCode.enter?0<=r&&!eventTargetContainsNode(t,["A"])&&E.rowActivated(t,{data:e,index:r}):t.which===KeyCode.space?(E.processSelectionEvent(t,{data:e,index:r}),t.preventDefault()):t.which===KeyCode.upArrow||t.which===KeyCode.downArrow?(e=E.props.selection)&&(!e.selectOnFocus||!t.shiftKey&&t.ctrlKey)||(t.persist(),window.setTimeout(function(){var e;E.focusIndex!=r&&(e=ObservableLike.getValue(E.state.rows[E.focusIndex]))&&E.processSelectionEvent(t,{data:e,index:E.focusIndex})},0)):t.which===KeyCode.pageDown?(o=E.getStats(),E.focusRow(Math.min(r+(o.lastRendered-o.firstRendered),E.state.rowCount-1),1),t.preventDefault()):t.which===KeyCode.pageUp?(o=E.getStats(),E.focusRow(Math.max(r-(o.lastRendered-o.firstRendered),0),-1),t.preventDefault()):t.which===KeyCode.home?(E.focusRow(0,1),t.preventDefault()):t.which===KeyCode.end&&(E.focusRow(E.state.rowCount-1,-1),t.preventDefault()))},E.onIntersect=function(e){if(E.state.virtualize){var t=E.context.root.scrollTop,r=E.state,o=r.firstRendered,i=r.firstMaterialized,n=r.lastRendered,s=r.lastMaterialized,a=r.rowCount,l=r.rowProportion,c=E.state.rowHeight;if((t===E.state.scrollTop||!e.length)&&E.listElement.current&&E.bodyElement.current){var d=E.bodyElement.current.children;if(0===c){if(0<d.length){for(var u=0,p=0,h=0;h<d.length;h++){var m=E.bodyElement.current.children[h].getBoundingClientRect().height;0<m&&(u+=m,p++)}0<p&&(c=u/p)}if(0===c)return;if(-1!==E.scrollToIndex)return void E.setState({firstMaterialized:Math.max(0,E.scrollToIndex-E.state.pageSize),lastMaterialized:E.scrollToIndex+Math.min(E.props.initialPageCount*E.state.pageSize,a-1),rowHeight:c})}for(var f,v,g,w,b=E.context.root.getBoundingClientRect(),x=i,y=s,R=y,I=x,h=0;h<d.length;h++){var z=d[h],C=getAttributeAsNumber(z,"data-row-index"),M=z.getBoundingClientRect();i<=C&&C<=s&&(M.bottom<b.top-E.state.pageSize*(l*c)?x++:M.top>b.bottom+E.state.pageSize*(l*c)&&y--,C===i&&(f=z),C===s)&&(v=z),-1<C&&M.top<b.bottom&&M.bottom>b.top&&(I=Math.max(I,C),R=Math.min(R,C))}l<1?y<x||R===x||I===y?a-1<=I?x=Math.ceil(y-(b.height/c+E.state.pageSize)):(g=t-(E.listElement.current.offsetTop-E.context.root.offsetTop),x=Math.max(0,Math.min(a-1,Math.floor(g/(l*c)))-E.state.pageSize),y=Math.min(a-1,x+Math.ceil(b.height/(l*c)+E.state.pageSize-1)),R=I=-1):(x=Math.min(x,R-E.state.pageSize),y=Math.max(y,I+E.state.pageSize-1),R=I=-1):y<x?(g=t-(E.listElement.current.offsetTop-E.context.root.offsetTop),x=Math.max(0,Math.min(a-1,Math.floor(g/c))-E.state.pageSize),y=Math.min(a-1,x+Math.ceil(b.height/c+E.state.pageSize-1)),R=I=-1):(x===i&&f&&0<(w=(M=f.getBoundingClientRect()).top-b.top)&&(x-=Math.ceil(w/c)),y===s&&v&&(M=v.getBoundingClientRect(),0<(w=b.bottom-M.bottom))&&(y+=Math.ceil(w/c))),x=Math.max(x,0),y=Math.min(y,a-1),x===i&&R===o&&y===s&&I===n&&c===E.state.rowHeight&&t===E.state.scrollTop||E.setState({firstMaterialized:x,firstRendered:R,lastMaterialized:y,lastRendered:I,rowHeight:c,scrollTop:t})}}},E.onPointerDownBody=function(e){E.selectOnFocus=!1},E.getInitialTabbableRow=function(){var e=E.props,t=e.defaultTabbableRow,r=e.itemProvider,o=e.selection;if(t)return t;if(o)for(var i=0;i<r.length;i++)if(o.selectable(i))return i;return 0},E.getHeight=function(e){for(var t=0,r=E.props.rowHeights||[],o=0;o<e&&o<r.length;o++)t+=r[o];return t},e.itemProvider.length),r=e.pageSize;if(E.state={columnCount:1,eventDispatch:e.eventDispatch||new EventDispatch,firstMaterialized:0,firstRendered:0,itemProvider:e.itemProvider,lastMaterialized:E.props.virtualize?Math.min(e.initialPageCount*r,t-1):t-1,lastRendered:E.props.virtualize?Math.min(e.initialPageCount*r,t-1):t-1,overlays:new ObservableArray,pageSize:r,renderedRows:{},rowCount:t,rowHeight:e.rowHeight||0,rowProportion:e.rowHeight&&e.maxHeight?Math.min(1,e.maxHeight/(e.rowHeight*t)):1,rows:{},scrollTop:0,virtualize:!!e.virtualize},e.behaviors)for(var o=0,i=e.behaviors;o<i.length;o++){var n=i[o];n.initialize&&n.initialize(e,E,E.state.eventDispatch)}return E}return __extends(e,s),e.getDerivedStateFromProps=function(e,t){var r=e.itemProvider.length,o=t.firstMaterialized,i=t.lastMaterialized,r=(r!==t.rowCount&&(o=Math.max(0,Math.min(t.firstMaterialized,r)),i=t.virtualize?Math.max(o,Math.min(t.lastMaterialized+(t.lastMaterialized===t.rowCount-1||t.lastMaterialized===t.rowCount?e.pageSize:0),r-1)):r-1),{firstMaterialized:o,itemProvider:e.itemProvider,lastMaterialized:i,pageSize:e.pageSize,rowCount:r,rowProportion:Math.min(1,(e.maxHeight||1e5)/(t.rowHeight*(r-(i-o))))});return e.itemProvider===t.itemProvider&&e.columnCount===t.columnCount||(r.columnCount=e.columnCount,r.renderedRows={},r.rows={}),r},e.prototype.render=function(){var o=this,e=this.props,t=e.ariaRowOffset,r=e.className,i=e.focuszoneProps,n=e.id,s=e.maxWidth,a=e.minWidth,l=e.width,e=this.state,c=e.firstMaterialized,d=e.lastMaterialized,u=e.rowCount,e=e.rowProportion,p=this.focusIndex,h=this.props.role||(this.props.selection?"listbox":"list"),m="table"===h||"grid"===h||"treegrid"===h,f=[],v=0,g=c,w=Math.max(0,u-d-1),b=0,x=Number.MAX_SAFE_INTEGER,y=0;if(-1!==p&&(x=Math.max(0,p-3),y=Math.min(u,p+3),x<c?(v=x,g=c-(y=Math.min(y,c-1))-1):d<y&&(w=(x=Math.max(x,d+1))-d-1,b=Math.max(0,u-y-1))),e<1&&(g+=Math.min(this.state.pageSize,c)),f.push(this.renderSpacer("st1",v)),x<c)for(var R=x;R<=y;R++)f.push(this.renderRow(R));f.push(this.renderSpacer("st2",g));for(R=c;R<=d;R++)f.push(this.renderRow(R));if(f.push(this.renderSpacer("sb2",w,!0)),d<y)for(R=x;R<=y;R++)f.push(this.renderRow(R));return f.push(this.renderSpacer("sb1",b,!0)),React.createElement(UncheckedObserver,{itemProvider:{filter:function(e,t){o.props.selection&&o.props.selection.onItemsChanged(e,t);var r,t={renderedRows:{},rows:{}};return e.removedItems&&o.focusIndex>=e.index&&e.index+e.removedItems.length>=o.focusIndex&&(o.focusIndex=-1),-1!==o.state.rowCount&&(r=(e.addedItems?e.addedItems.length:0)-(e.removedItems?e.removedItems.length:0))&&(t.rowCount=o.state.rowCount+r,t.firstMaterialized=Math.max(0,Math.min(o.state.firstMaterialized,t.rowCount-1)),t.lastMaterialized=o.state.virtualize?Math.max(t.firstMaterialized,Math.min(o.state.lastMaterialized+(e.index>=o.state.firstMaterialized&&e.index<=o.state.lastMaterialized+1?Math.min(o.state.pageSize,r):0),t.rowCount-1)):t.rowCount-1),o.setState(t),!1},observableValue:this.props.itemProvider}},React.createElement(FocusWithin,{onBlur:this.onBlur},function(e){e=React.createElement("table",{"aria-colcount":m?o.props.ariaColumnCount||o.props.columnCount:void 0,"aria-label":o.props.virtualize?format(Resources.VirtualizedListLabelFormat,o.props.ariaLabel):o.props.ariaLabel,"aria-rowcount":m?o.state.itemProvider.length+t:void 0,className:css(r,"bolt-list body-m relative",o.props.showScroll?void 0:"scroll-hidden"),id:getSafeId(n),onBlur:e.onBlur,onClick:o.onClick,onContextMenu:o.onDispatch,onDoubleClick:o.onDoubleClick,onDragEnd:o.onDispatch,onDragEnter:o.onDispatch,onDragExit:o.onDispatch,onDragOver:o.onDispatch,onDragStart:o.onDispatch,onDrop:o.onDispatch,onFocus:e.onFocus,onKeyDown:o.onKeyDown,onKeyUp:o.onDispatch,onPointerDown:o.onDispatch,ref:o.listElement,role:h,style:{maxWidth:s,minWidth:a,width:l},tabIndex:0},o.props.renderHeader&&o.props.renderHeader(),React.createElement("tbody",{className:"relative",onFocus:o.onFocusBody,onPointerDown:o.onPointerDownBody,ref:o.bodyElement,role:"listbox"===h||"list"===h||"menu"===h?"presentation":void 0},o.renderOverlay(o.listElement),f));return e=i?React.createElement(FocusZone,__assign({},i,{skipHiddenCheck:!0}),e):e}))},e.prototype.componentDidMount=function(){this.context.register(this.onIntersect),this.props.virtualize&&document.addEventListener("keydown",this.onVirtualizeKeyDown)},e.prototype.componentDidUpdate=function(){var e=this.scrollToIndex,t=this.onScrollComplete;if(-1!==e&&this.state.rowHeight){var r=this.bodyElement.current,o=this.state,i=o.firstMaterialized,o=o.lastMaterialized;if(i<=e&&e<=o&&r)for(var n=0;n<r.children.length;n++){var s=r.children[n];if(cellFromElement(s).rowIndex===e){s.scrollIntoView(this.scrollToOptions);break}}this.onScrollComplete=void 0,this.scrollToIndex=-1,this.scrollToOptions=void 0,t&&t(e)}},e.prototype.componentWillUnmount=function(){this.context.unregister(this.onIntersect),this.props.virtualize&&document.removeEventListener("keydown",this.onVirtualizeKeyDown)},e.prototype.addOverlay=function(t,e,r,o,i){void 0===o&&(o=0);var n=this.state.overlays,s=n.value.findIndex(function(e){return e.id===t}),r={render:r,id:t,rowIndex:e,zIndex:o+1,columnIndex:i};0<=s?n.change(s,r):n.push(r)},e.prototype.removeOverlay=function(t){var e=this.state.overlays,r=e.value.findIndex(function(e){return e.id===t});0<=r&&e.splice(r,1)},e.prototype.getFocusIndex=function(){return this.focusIndex},e.prototype.getStats=function(){return{firstMaterialized:this.state.firstMaterialized,firstRendered:this.state.firstRendered,lastMaterialized:this.state.lastMaterialized,lastRendered:this.state.lastRendered}},e.prototype.scrollIntoView=function(e,t,r){var o=this.state,i=o.firstMaterialized,n=o.lastMaterialized,s=o.pageSize,a=o.rowCount,l=o.rowHeight,o=o.rowProportion;if(0<=e&&e<this.state.rowCount){var c=this.bodyElement.current;if(i<=e&&e<=n&&c){for(var d=0;d<c.children.length;d++){var u=c.children[d];if(cellFromElement(u).rowIndex===e){u.scrollIntoView(t);break}}r&&r(e)}else{this.onScrollComplete&&this.onScrollComplete(-1),this.onScrollComplete=r,this.scrollToIndex=e,this.scrollToOptions=t;i=o<1?s:0;l&&this.setState({firstMaterialized:Math.max(0,e-i),lastMaterialized:Math.min(a-1,e+i)})}}},e.prototype.focusRow=function(o,i){var n=this;return void 0===i&&(i=1),new Promise(function(r){n.scrollIntoView(o,{block:"center"},function(e){var t;e===o&&n.bodyElement.current&&(t=n.bodyElement.current.querySelector("[data-row-index='"+e+"']"))&&(t.getAttribute("tabindex")?t.focus():(t=Math.min(n.state.rowCount-1,Math.max(0,e+i)))!==e?n.focusRow(t,i):t!==n.focusIndex&&n.focusRow(t,-i)),r()})})},e.prototype.processSelectionEvent=function(e,t){var r,o,i=this.props,n=i.selection,i=i.enforceSingleSelect;n&&!n.selectable(t.index)||(n&&(r=t.index,i=!i&&n.multiSelect,0<=this.pivotIndex&&e.shiftKey&&i?n.select(Math.min(this.pivotIndex,r),Math.abs(this.pivotIndex-r)+1,e.ctrlKey||e.metaKey,i):(o=e.which===KeyCode.space,(e.ctrlKey||e.metaKey||n.alwaysMerge||o)&&i?n.toggle(r,!0,i):n.select(r,1,!1,i)),e.shiftKey||(this.pivotIndex=r)),this.rowSelected(e,t))},e.prototype.renderLoadingRow=function(e,t){return React.createElement(ListItem,{className:"bolt-list-row-loading",details:t,index:e},React.createElement("div",{className:"shimmer shimmer-line",style:{width:80*Math.random()+20+"%"}},"Â "))},e.prototype.renderOverlay=function(i){var n=this,e=this.state,s=e.firstMaterialized,a=e.lastMaterialized,e=e.overlays;return React.createElement(Observer,{overlays:e},function(e){var o=n.bodyElement.current;return 0<e.overlays.length&&o?React.createElement("div",{className:"bolt-list-overlay-container absolute"},e.overlays.map(function(e){var t,r;return(-1===e.rowIndex||!(e.rowIndex<s||e.rowIndex>a)||getDragInProgress())&&(t=i.current&&i.current.querySelector("[data-row-index='"+e.rowIndex+"']"),t=n.props.overlay?null==t?void 0:t.querySelector(n.props.overlay):t,r=null==(r=i.current)?void 0:r.querySelector("[data-column-index='"+e.columnIndex+"']"),t)?r?React.createElement("div",{className:"bolt-list-overlay flex-row absolute",id:getSafeId(e.id),key:e.id,style:{height:t.offsetHeight,width:r.offsetWidth,top:t.getBoundingClientRect().top-o.getBoundingClientRect().top,left:r.getBoundingClientRect().left-o.getBoundingClientRect().left,zIndex:10*e.zIndex}},e.render({rowElement:r})):React.createElement("div",{className:"bolt-list-overlay flex-row absolute",id:getSafeId(e.id),key:e.id,style:{height:t.offsetHeight,top:t.getBoundingClientRect().top-o.getBoundingClientRect().top,zIndex:10*e.zIndex}},e.render({rowElement:t})):null})):null})},e.prototype.renderRow=function(s){var a=this,e=this.props.itemProvider,t=this.state,r=t.renderedRows,t=t.rows;if(!(r=r[s])){var l=t[s];if(!(l=l||(e.getItem?e.getItem(s):e.value[s])))return null;t[s]=l;e=this.props.selection,t=e?{observableValue:e,filter:function(e){for(var t=0,r=e;t<r.length;t++){var o=r[t];if(s>=o.beginIndex&&s<=o.endIndex)return!0}return!1}}:void 0,r=React.createElement(UncheckedObserver,{item:l,key:s,selection:t},function(e){var t=a.props,r=t.selectableText,o=t.renderRow,t=t.renderLoadingRow,i=a.focusIndex,i=0<=i?i:a.getInitialTabbableRow(),n=ObservableLike.getValue(l),r={selectableText:r,ariaBusy:!e.item,ariaRowOffset:a.props.ariaRowOffset+1,data:n,eventDispatch:a.state.eventDispatch,excludeTabStop:a.props.excludeTabStop||i!==s,listProps:a.props,onFocusItem:a.onFocusItem,singleClickActivation:a.props.onActivate&&a.props.singleClickActivation};return e.item?o(s,e.item,r):t?t(s,r):a.renderLoadingRow(s,r)});this.state.renderedRows[s]=r}return r},e.prototype.renderSpacer=function(r,e,t){var o=this,t=!t&&null!=(t=this.props.rowHeights)&&t.length?this.getHeight(e):e*this.state.rowHeight*this.state.rowProportion;return React.createElement("tr",{"aria-hidden":"true",className:"bolt-list-row-spacer invisible",key:r,ref:function(e){var t=o.spacerElements[r];e?t!==e&&(t&&o.context.unobserve(e),o.context.observe(e),o.spacerElements[r]=e):t&&(o.context.unobserve(t),delete o.spacerElements[r])},role:"presentation"},React.createElement("td",{className:"bolt-list-cell-spacer invisible",colSpan:this.props.columnCount,style:{height:t+"px"}}))},e.prototype.rowActivated=function(e,t){this.state.eventDispatch.dispatchEvent(e,t,"activate"),this.props.onActivate&&this.props.onActivate(e,t)},e.prototype.rowSelected=function(e,t){this.state.eventDispatch.dispatchEvent(e,t,"select"),this.props.onSelect&&this.props.onSelect(e,t)},e.prototype.rowFocused=function(e,t){this.state.eventDispatch.dispatchEvent(e,t,"focus"),this.props.onFocus&&this.props.onFocus(e,t)},e.contextType=IntersectionContext,e.defaultProps={ariaRowOffset:0,columnCount:1,focuszoneProps:{direction:FocusZoneDirection.Vertical},initialPageCount:3,maxHeight:1e5,pageSize:10,singleClickActivation:!1,selectRowOnClick:!0,virtualize:!0},e}(React.Component),ScrollableList=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=React.createRef(),e.scrollableElement=React.createRef(),e}return __extends(e,t),e.prototype.render=function(){return React.createElement(Intersection,{rootMargin:window.innerHeight/2},React.createElement("div",{ref:this.scrollableElement,onScroll:this.props.onScroll,className:css(this.props.outerClassName,"flex-grow","scroll-auto")},React.createElement(List,__assign({},this.props,{ref:this.list}))))},e.prototype.addOverlay=function(e,t,r,o,i){if(void 0===o&&(o=0),this.list.current)return this.list.current.addOverlay(e,t,r,o,i)},e.prototype.getStats=function(){return this.list.current?this.list.current.getStats():{firstMaterialized:-1,firstRendered:-1,lastMaterialized:-1,lastRendered:-1}},e.prototype.removeOverlay=function(e){if(this.list.current)return this.list.current.removeOverlay(e)},e.prototype.focusRow=function(e,t){return void 0===t&&(t=1),this.list.current?this.list.current.focusRow(e,t):Promise.resolve()},e.prototype.getFocusIndex=function(){return this.list.current?this.list.current.getFocusIndex():-1},e.prototype.scrollIntoView=function(e,t){if(this.list.current)return this.list.current.scrollIntoView(e,t)},e.prototype.scrollTo=function(e){this.scrollableElement.current&&(this.scrollableElement.current.scrollTop=e)},e}(React.Component),SimpleList=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.list=React.createRef(),e.renderListItem=function(e,t,r){return renderListItem(e,r,renderListCell(t))},e}return __extends(e,t),e.prototype.render=function(){var e={selectableText:this.props.selectableText,className:this.props.className,columnCount:1,eventDispatch:this.props.eventDispatch,focuszoneProps:this.props.focuszoneProps,id:this.props.id,initialPageCount:this.props.initialPageCount,itemProvider:this.props.itemProvider,maxHeight:this.props.maxHeight,onActivate:this.props.onActivate,onFocus:this.props.onFocus,onSelect:this.props.onSelect,pageSize:this.props.pageSize,renderRow:this.renderListItem,selection:this.props.selection,width:this.props.width,virtualize:this.props.virtualize};return this.props.scrollable?React.createElement(ScrollableList,__assign({},e,{ref:this.list})):React.createElement(List,__assign({},e,{ref:this.list}))},e.prototype.addOverlay=function(e,t,r,o){if(void 0===o&&(o=0),this.list.current)return this.list.current.addOverlay(e,t,r,o)},e.prototype.removeOverlay=function(e){if(this.list.current)return this.list.current.removeOverlay(e)},e.prototype.focusRow=function(e,t){return void 0===t&&(t=1),this.list.current?this.list.current.focusRow(e,t):Promise.resolve()},e.prototype.getFocusIndex=function(){return this.list.current?this.list.current.getFocusIndex():-1},e.prototype.getStats=function(){return this.list.current?this.list.current.getStats():{firstMaterialized:-1,firstRendered:-1,lastMaterialized:-1,lastRendered:-1}},e.prototype.scrollIntoView=function(e,t){if(this.list.current)return this.list.current.scrollIntoView(e,t)},e}(React.Component);function renderListItem(e,t,r){return React.createElement(ListItem,{details:t,index:e},r)}function ListItem(r){var o=r.children,i=r.details,n=r.index,s=r.linkProps,a=r.itemId,l=r.tabIndex,c=i.selectableText,d=i.ariaBusy,u=i.ariaDescribedBy,p=i.ariaLabel,h=i.ariaPosInSet,m=i.ariaSetSize,f=i.excludeFocusZone,e=i.listProps,v=e.selection,g=e.singleClickActivation;return React.createElement(FocusWithin,{onFocus:function(e){r.details.onFocusItem(r.index,e)}},function(t){return React.createElement(FocusZoneContext.Consumer,null,function(e){e={"aria-busy":d,"aria-describedby":u,"aria-label":p,"aria-posinset":void 0===h?n+1:null===h?void 0:h,"aria-selected":v&&v.selected(n),"aria-setsize":void 0===m?r.details.listProps.itemProvider.length:null===m?void 0:m,className:css(r.className,"bolt-list-row",0===n&&"first-row",s&&"bolt-link",v&&v.selected(n)&&"selected",t.hasFocus&&"focused",g&&"single-click-activation",c&&"selectable-text"),"data-focuszone":f||v&&!v.selectable(n)?void 0:e.focuszoneId,"data-row-index":n,"data-itemid":a,tabIndex:null!=l?l:getTabIndex(i),onBlur:t.onBlur,onFocus:t.onFocus,role:v?"option":"listitem"};return React.createElement(FocusZone,{direction:FocusZoneDirection.Horizontal},s?React.createElement("a",__assign({},getDefaultLinkProps(s),e),React.createElement("div",{className:"bolt-list-cell","data-column-index":0},React.createElement("div",{className:"bolt-list-cell-content flex-row"},o))):React.createElement("tr",__assign({},e),React.createElement("td",{className:"bolt-list-cell","data-column-index":0},React.createElement("div",{className:"bolt-list-cell-content flex-row"},o))))})})}function renderListCell(e,t){void 0===t&&(t=!0);var r=void 0,o=React.createElement("span",{className:"text-ellipsis body-m"},"string"==typeof e||"number"==typeof e?e:e.textNode||e.text),t=o=t?React.createElement(Tooltip,{overflowOnly:!0},o):o,i=css("bolt-list-cell-child flex-row flex-center");return"string"!=typeof e&&"number"!=typeof e&&(r=e.textClassName,e.iconProps&&(t=React.createElement(React.Fragment,null,Icon(__assign(__assign({},e.iconProps),{className:css("icon-margin",e.iconProps.className)})),o)),e.href)?React.createElement(Link,{className:css(r,i,"scroll-hidden"),href:e.href,rel:e.hrefRel,target:e.hrefTarget,excludeTabStop:!0,subtle:!0},t):React.createElement("span",{className:css(r,i,"bolt-list-cell-text")},t)}function getAttributeAsNumber(e,t){e=e.getAttribute(t);return e?parseInt(e,10):-1}function cellFromElement(e){for(var t,r=-1,o=-1,i=null;e;){if(-1!==(t=getAttributeAsNumber(e,"data-column-index"))&&(r=t,i=e),-1!==(t=getAttributeAsNumber(e,"data-row-index"))){o=t;break}if(e.classList.contains("bolt-list")){e=null;break}e=e.parentElement}return{cellElement:i,cellIndex:r,rowElement:e,rowIndex:o}}function cellFromEvent(e){return cellFromElement(e.target)}export{List,ScrollableList,SimpleList,renderListItem,ListItem,renderListCell,cellFromElement,cellFromEvent};